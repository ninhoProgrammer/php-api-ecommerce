<?php
require_once 'middleware.php';
require_once 'db.php';

$input = json_decode(file_get_contents('php://input'), true);
$id = $_GET['id'] ?? null;

if (!$id || !isset($input['name'], $input['price'], $input['image'])) {
    send_json_error("Missing product ID or data", 422);
}

$stmt = $pdo->prepare("UPDATE products SET name = ?, price = ?, image = ? WHERE id = ?");
$stmt->execute([$input['name'], $input['price'], $input['image'], $id]);

send_json_success(["message" => "Product updated"]);
